
#+CAPTION: demonstrating fluid gestures, five finger gestures, tap gestures and touchscreen gestures
[[file:gestures.gif]]
* Motivation 
:PROPERTIES:
:ID:       d6ce66b4-caba-44f0-83a1-016c386249fa
:END:
:RESOURCES:
:END:
:LOGBOOK:
- Newly Created           [2020-01-17 Fri 03:02:06]
:END:
- I wanted an application that will allow me to fluidly express my intent through the touchpad and touchscreen. 
- I felt shackled by one-shot gestures from [[https://github.com/bulletmark/libinput-gestures][libinput-gestures]] but from it I found the utility of eight-directional gestures.
- I felt [[https://github.com/iberianpig/fusuma][fusuma]] was lacking Although it was more fluid.
- I really missed keeping my fingers moving across the touchpad to switch applications. 
- I wanted tap gestures.
- I wanted five finger gestures. 
- I wanted usable gestures for my touchscreen.
So I wrote this.

* Features
:PROPERTIES:
:ID:       0255c74a-c55a-4107-98d5-ec1f67a7c7e2
:END:
:RESOURCES:
:END:
:LOGBOOK:
- Newly Created           [2020-01-17 Fri 07:37:48]
:END:
- vanilla gestures ::
 features present in [[https://github.com/bulletmark/libinput-gestures][libinput-gestures]] and [[https://github.com/iberianpig/fusuma][fusuma]].
- 5 finger gestures :: 
This means that you can place 5 fingers on the touchpad and that is recognized as another class of gestures. BTN_TOOL_QUINTTAP must supported. This feature must supported by your driver + touchpad.
check by running =evtest /dev/input/$(cat /proc/bus/input/devices | grep -iA 5 'touchpad' |grep -oP 'event[0-9]+') | grep BTN_TOOL_QUINTTAP=. if it prints a line containing ~"BTN_TOOL_QUINTTAP"~, your touchpad+driver support it.
- tap gestures ::
This means that tapping the touchpad with 4 or 5 fingers is recognized as a gesture.
- Touchscreen gestures ::
Extend gestures to touchscreen.
- Fluid gestures :: 
Allow the user to do different things without raising their fingers from the touchpad. This takes advantage of the fact that gesture execution is separated into 3 parts, start, update, and end, by doing complementary actions in each.

For example, assume the shortcut to switch windows is "CTRL + ALT" + direction, where direction is "LEFT", "RIGHT", "UP", "DOWN".

to switch windows fluidly, "CTRL + ALT" are held down programmatically on a start gesture event, then depending on which direction the user is swiping while fingers are still on the touchpad, dynamically generate direction commands. Then when the user raises their fingers, which is an end gesture event, the "CTRL + ALT" are released programmatically.
* Dependencies 
:PROPERTIES:
:ID:       96ea91ca-f6d0-47f2-bdaa-52dd6903122b
:END:
:RESOURCES:
:END:
:LOGBOOK:
- Newly Created           [2020-01-17 Fri 04:10:31]
:END:
- python dependencies ::
  subprocess, pathlib, shlex, threading, queue, time, os, sys, math
- *nix dependencies ::
  cat, grep
- dependencies ::
  stdbuf, evtest
  - evtest ::
    will maybe replaced by evemu-record in the future.
  - daemonize ::
    using =& disown= should work as well but this is a sure way to detach and run this on a global scale.
- default dependencies (if running default configuration) :: 
  - evemu ::
    need evemu-do (alternative to xdotool that I wrote) in $PATH.

* Installation/Uninstallation
:PROPERTIES:
:ID:       58e8054c-7787-4e3c-ba56-434ae32a4741
:END:
:RESOURCES:
:END:
:LOGBOOK:
CLOCK: [2020-02-04 Tue 21:36:22]--[2020-02-04 Tue 23:35:54] =>  1:59
- Newly Created           [2020-02-04 Tue 21:35:57]
:END:
:NOTES:
- installation ::
  
  - run ./install.sh
    - it should handle most things.
    - may need to install =daemonize= by hand. If on Arch, I recommend =daemonize-git= from AUR.
    - may want to look at where it places things and if that meets your setup.
- uninstallation ::
  
  - run ./uninstall.sh
  - removes everything except that what was installed by the package manager. To uninstall those, remove =evtest= and =daemonize=.
:END:
* Customization
:PROPERTIES:
:ID:       3e5fe336-63c6-4e7f-a69b-e1ab4315260c
:END:
:RESOURCES:
:END:
:LOGBOOK:
- Newly Created           [2020-03-02 Mon 04:42:21]
:END:
:NOTES:
- currently customizable ::
 
 
  - swipe, pinch
  - 3,4,5 finger start and end gestures
- example ::
#+begin_src js 
  {'swipe': {
      '3': {
          'l' : {'start': ['evemu_do alt down', 'evemu_do tab'], 'update': {'l': [], 'r': [], 'u': [], 'd': [], 'lu': [], 'rd': [], 'ld': [], 'ru': []}, 'end': ['evemu_do alt up'], 'rep': ''}
      }
  }
  }
#+end_src
- breakdown ::

  
  - (swipe,pinch) ::
    - define if the gesture is a swipe or a pinch 
  - (3,4,5) ::
    - define the number of fingers to activate the gesture
  - ('t', 'l', 'r',...,'ru') :: define tap and the 8 directions a swipe can be in.
  - (start,end) ::
    - what to do when the gesture starts or ends.
  - (slated for a future update) ::
   
 
    - (update) ::
      - what to do when the gesture is on going. going to start out with just 4 directions as that suffices my needs (and probably most others) but will expand to 8 directional configuration should there be demand.
    - (rep) ::
      - how frequently is gesture update run. can make this directional as well, but don't have plans for that yet.
    - (touchscreen, touchpad (even device level tag)) :: 
       to specify what a specific set of gestures apply to.
:END:
* Alternatives 
:PROPERTIES:
:ID:       480d65ce-33d2-4222-9098-ffee46f42019
:END:
:RESOURCES:
:END:
:LOGBOOK:
- Newly Created           [2020-01-17 Fri 03:16:58]
:END:
- [[https://github.com/bulletmark/libinput-gestures][libinput-gestures]] ::
  
  - what I used to use. 
  - Works well, just that the gestures are one-shot, meaning that the command attached to a gesture is executed only once per full swipe. 
  - depends on libinput. 
- [[https://github.com/iberianpig/fusuma][fusuma]] ::
  
  - Although it doesn't have one-shot limitation, it didn't support commands to run when the gesture begins and ends. This is useful for use-cases like switching applications which require alt-down to be pressed.
  - didn't support eight-directional gestures.

* TODOS 
:PROPERTIES:
:ID:       a0f0322f-5cee-46b0-acb1-82c5122bf600
:END:
:RESOURCES:
:END:
:LOGBOOK:
- Newly Created           [2020-01-17 Fri 03:06:38]
:END:
** TODO add features [0/2]
:PROPERTIES:
:ID:       3bc8e684-d676-46fc-b972-7b9226d417f6
:END:
:RESOURCES:
:END:
:LOGBOOK:
- State "TODO"       from "NEXT"       [2020-03-02 Mon 04:58:17]
- State "TODO"       from              [2020-01-17 Fri 03:07:08]
- Newly Created           [2020-01-17 Fri 03:06:59]
:END:
- [-][2/7] enable customization by refactoring code.
  - [X] commands for gesture start
  - [X] commands for gesture end
  - [ ] commands for touchscreen
  - [ ] commands for gesture update
  - [ ] rep rate
  - [ ] detach implementation from personal workflow
  - [ ] more nuanced application of gestures to different attached devices
- [ ] use [[https://github.com/bulletmark/libinput-gestures][libinput-gestures ]]config file syntax.
- [ ] use [[https://github.com/iberianpig/fusuma][fusuma]] config file syntax.

** DONE enrich readme  
CLOSED: [2020-02-04 Tue 23:35:13]
:PROPERTIES:
:ID:       2f6a4067-3cd9-42ca-8003-64f5ca0f471d
:END:
:RESOURCES:
:END:
:LOGBOOK:
- Newly Created           [2020-01-17 Fri 03:15:49]
:END:
** DONE Write script to fulfill dependencies automatically 
CLOSED: [2020-02-04 Tue 23:35:22]
:PROPERTIES:
:ID:       6ed1e765-e89b-4649-be07-a95c3895698e
:END:
:RESOURCES:
:END:
:LOGBOOK:
- State "TODO"       from              [2020-01-17 Fri 04:26:33]
- Newly Created           [2020-01-17 Fri 04:26:25]
:END:
** TODO Implement C++ version
:PROPERTIES:
:ID:       6fd1e765-e89b-4649-be07-a95c3895698e
:END:
:RESOURCES:
:END:
:LOGBOOK:
- State "TODO"       from              [2020-02-03 Mon 04:26:33]
- Newly Created           [2020-02-03 Mon 04:26:25]
:END:

